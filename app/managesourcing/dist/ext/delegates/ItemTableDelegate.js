sap.ui.define(["sap/ui/mdc/TableDelegate","sap/ui/mdc/Field","sap/ui/model/json/JSONModel","sap/ui/model/Filter","sap/ui/model/FilterOperator","sap/ui/mdc/ValueHelp","sap/ui/mdc/valuehelp/content/FixedList","sap/ui/mdc/valuehelp/content/FixedListItem","sap/ui/mdc/valuehelp/Popover"],function(e,t,a,i,n,r,l,s,o){"use strict";var d=Object.assign({},e);var u=async function(e){return new Promise(t=>{const a=e.getDelegate().payload&&e.getDelegate().payload.modelName,i={modelName:a,control:e,resolve:t};p.call(i)})};var p=async function(){this.control.detachModelContextChange(p,this);const e=this.modelName,t=this.control.getModel(e);var a=this.control.getBindingContext();if(t&&a){this.resolve(t)}else{this.control.attachModelContextChange(p,this)}};d.fetchProperties=async function(e){return u(e).then(async t=>{debugger;var a=[];try{var i=e.getBindingContext();var n=await e.getModel().bindList("terms",i,[],[],{$expand:"ranges($select=keyid,description)"}).requestContexts();for(const t of n){var r=await t.requestObject("ranges");var l=await t.requestProperty("id");var s=await t.requestProperty("description");var o=await t.requestProperty("datatype");a.push({key:l,label:s,path:"",dataType:"sap.ui.model.type."+o});e.addColumn(c(e,e.getId()+"---col-"+l,l,o,r,t))}e.rebind();return a}catch(e){console.log(e)}})};var c=function(e,t,i,n,r,l){var s=null;var o={selectedValue:[],countries:[{key:"US",name:"United States"},{key:"DE",name:"Germany"},{key:"IN",name:"India"}]};var d=new a(o);if(r&&r.length>0){s=v(e,t,i,n,r,l)}else{s=y(e,t,i,n,r,l)}var u=new sap.ui.mdc.table.Column(t,{header:i,dataProperty:i,template:s});var o={items:[]};for(const e of r){o.items.push({keyid:e.keyid,description:e.description})}var d=new a(o);u.setModel(d,"valueHelp");return u};var v=function(e,i,n,d,u,p){var c={items:[]};for(const e of u){c.items.push({keyid:e.keyid,description:e.description})}var v=new a(c);var y=new l({filterList:false,useFirstMatch:false,items:{path:"valueHelp>/items",template:new s({key:"{valueHelp>keyid}",text:"{valueHelp>description}",additionalText:"{valueHelp>keyid}"})}});y.setModel(v,"valueHelp");var m=new o({content:y});m.setModel(v,"valueHelp");var g=new r({delegate:{name:"managesourcing/ext/delegates/ValueHelpDelegate",payload:{searchKeys:["key","name"],shouldOpenOnClick:true}},typeahead:m});g.setModel(v,"valueHelp");var h=new t(i+"--Field--"+n,{value:{path:"terms",formatter:function(e){}.bind({key:n,datatype:d})},editMode:"{=${ui>/isEditable}=== true ? 'Editable' : 'ReadOnly'}",display:"Description",valueHelp:g});h.setModel(v,"valueHelp");return h};var y=function(e,a,i,n,r,l){return new t(a+"--Field--"+i,{value:{path:"terms",formatter:function(e){if(!e){return"X"}var t=e.filter(e=>e.id===this.key);if(t.length<1){return}if(n==="Integer")return parseInt(t[0].value);else return t[0].value}.bind({key:i,datatype:n}),type:"sap.ui.model.type."+n},editMode:"{=${ui>/isEditable}=== true ? 'Editable' : 'ReadOnly'}"})};d.addItem=async(e,t)=>{const a=e.getId()+"---col-"+t;var r=await e.getBindingContext().requestProperty("IsActiveEntity");const l=[new i("id",n.Eq,t)];var s=await e.getModel().getKeepAliveContext("/Term(id='"+eventId+"',IsActiveEntity="+r+")");var o=await s.requestProperty("datatype");return await c(e,a,t,o,[])};d.updateBindingInfo=function(t,a){debugger;e.updateBindingInfo.call(d,t,a);if(!t.getBindingContext()){return}a.path=t.getBindingContext().getPath()+t.getPayload().bindingPath;a.parameters.$expand="terms($select=id,value)";a.parameters.$count=true;a.parameters.$$aggregation={hierarchyQualifier:"ItemHierarchy"}};return d});
//# sourceMappingURL=ItemTableDelegate.js.map