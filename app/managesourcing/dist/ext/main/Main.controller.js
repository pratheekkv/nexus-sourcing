sap.ui.define(["sap/fe/core/PageController"],function(t){"use strict";return t.extend("managesourcing.ext.main.Main",{onInit:function(){t.prototype.onInit.apply(this);managesourcing.control.IconTab.IconTabHeader.prototype.validateTab=$.proxy(function(t){var e=this.getView().getModel("ui").getProperty("/isEditable");if(e){return false}return true},this);this.getAppComponent().getRouter("ProjectMain").attachRoutePatternMatched(this._onRouteMatched,this)},_onRouteMatched:function(t){var e=t.getParameter("name");if(e!=="Details"&&e!=="ProjectMain"){return}var i=this.getView().getModel();var a=i.getMetaModel().requestObject("/Project");a.then(this._onMetadataLoaded.bind(this))},_onMetadataLoaded:async function(){try{await this._createNewDocument()}catch(t){sap.m.MessageToast.show(t.toString())}},_createNewDocument:async function(){var t=await this.getAppComponent().getModel().bindList("/Project").requestContexts();this.getExtensionAPI().routing.navigate(t[0],{preserveHistory:false})},onModelContextChange:async function(){var t=this.getView()?.getBindingContext();var e=await(t?.requestProperty("IsActiveEntity"));if(e!==undefined){var i=this.getView()?.getModel("ui");i.setProperty("/isEditable",!e)}},handleWizardSave:async function(){await this.editFlow.saveDocument(this.getView().getBindingContext())},handleWizardCancel:async function(t){await this.editFlow.cancelDocument(this.getView().getBindingContext(),{cancelButton:t.getSource(),skipDiscardPopover:true})},onDialogNextButton:function(t){var e=this.getView().byId("createProjectWizard");var i=this.getView().byId(e.getCurrentStep());var a=e.getSteps().indexOf(i);var n=e.getSteps()[a+1];if(i&&!i.bLast){e.goToStep(n,true)}else{e.nextStep()}},onDialogBackButton:function(t){var e=this.getView().byId("createProjectWizard");var i=this.getView().byId(e.getCurrentStep());var a=e.getSteps().indexOf(i);var n=e.getSteps()[a-1];if(i){e.goToStep(n,true)}else{e.previousStep()}},onEdit:async function(t){var e=this.getView().getBindingContext();await this.getExtensionAPI().getEditFlow().editDocument(e)},createTask:async function(t){var e=this.getView().byId("taskList").getModel().bindList(this.getView().byId("taskList").getBindingContext().getPath()+"/tasks");this.getView().getModel("ui").setProperty("/isBusy",true);var i=this.getView().byId("taskList").getSelectedContexts()[0];var a=null,n=null;if(i){a=await(i?.requestProperty("type_id"));if(a==="Phase"){n=await(i?.requestProperty("node_id"))}}var s={node_id:" ",type_id:"Task",parent_id:n};await this.editFlow.createDocument(e,{creationMode:"Inline",data:s});this.getView().byId("taskList").refresh();this.getView().getModel("ui").setProperty("/isBusy",false)},createPhase:async function(t){var e=this.getView().byId("taskList").getModel().bindList(this.getView().byId("taskList").getBindingContext().getPath()+"/tasks");this.getView().getModel("ui").setProperty("/isBusy",true);var i=this.getView().byId("taskList").getSelectedContexts()[0];var a=null,n=null;if(i){a=await(i?.requestProperty("type_id"));if(a==="Phase"){n=await(i?.requestProperty("node_id"))}}var s={node_id:" ",type_id:"Phase",parent_id:n};await this.editFlow.createDocument(e,{creationMode:"Inline",data:s});this.getView().byId("taskList").refresh();this.getView().getModel("ui").setProperty("/isBusy",false)},onTabSelect:function(t){},onEventNav:function(t){this.getExtensionAPI().routing.navigate(t.getParameter("bindingContext"),{preserveHistory:false})}})});
//# sourceMappingURL=Main.controller.js.map