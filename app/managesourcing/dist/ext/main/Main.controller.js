sap.ui.define(["sap/fe/core/PageController"],function(t){"use strict";return t.extend("managesourcing.ext.main.Main",{onInit:function(){t.prototype.onInit.apply(this);this.getAppComponent().getRouter("ProjectMain").attachRoutePatternMatched(this._onRouteMatched,this)},_onRouteMatched:function(t){var e=this.getView().getModel();var i=e.getMetaModel().requestObject("/Project");i.then(this._onMetadataLoaded.bind(this))},_onMetadataLoaded:async function(){if(this._createDone){return}this._createDone=true;var t=this.getView()?.getBindingContext();if(t){return}try{await this._createNewDocument()}catch(t){sap.m.MessageToast.show(t.toString())}finally{this.getView().getModel("ui").setProperty("/isEditable",true)}},_createNewDocument:async function(){const t=this.getAppComponent().getModel().bindList("/Project");var e=await this.editFlow.createDocument(t,{creationMode:"NewPage",data:{}})},onModelContextChange:async function(){var t=this.getView()?.getBindingContext();var e=await(t?.requestProperty("IsActiveEntity"));if(e!==undefined){var i=this.getView()?.getModel("ui");i.setProperty("/isEditable",!e)}},handleWizardSave:async function(){await this.editFlow.saveDocument(this.getView().getBindingContext())},handleWizardCancel:async function(t){await this.editFlow.cancelDocument(this.getView().getBindingContext(),{cancelButton:t.getSource(),skipDiscardPopover:true})},onDialogNextButton:function(t){var e=this.getView().byId("createProjectWizard");var i=this.getView().byId(e.getCurrentStep());var a=e.getSteps().indexOf(i);var n=e.getSteps()[a+1];if(i&&!i.bLast){e.goToStep(n,true)}else{e.nextStep()}},onDialogBackButton:function(t){var e=this.getView().byId("createProjectWizard");var i=this.getView().byId(e.getCurrentStep());var a=e.getSteps().indexOf(i);var n=e.getSteps()[a-1];if(i){e.goToStep(n,true)}else{e.previousStep()}},onEdit:async function(t){var e=this.getView().getBindingContext();await this.getExtensionAPI().getEditFlow().editDocument(e)},createTask:async function(t){var e=this.getView().byId("taskList").getModel().bindList(this.getView().byId("taskList").getBindingContext().getPath()+"/tasks");this.getView().getModel("ui").setProperty("/isBusy",true);await this.editFlow.createDocument(e,{creationMode:"Inline",data:{type:"task"}});this.getView().byId("taskList").refresh();this.getView().getModel("ui").setProperty("/isBusy",false)},createPhase:async function(t){var e=this.getView().byId("taskList").getModel().bindList(this.getView().byId("taskList").getBindingContext().getPath()+"/tasks");this.getView().getModel("ui").setProperty("/isBusy",true);var i=this.getView().byId("taskList").getSelectedContexts()[0];var a=null,n=null;if(i){a=await(i?.requestProperty("type"));if(a==="phase"){n=await(i?.requestProperty("ID"))}}await this.editFlow.createDocument(e,{creationMode:"Inline",data:{type:"phase",ParentID:n}});this.getView().byId("taskList").refresh();this.getView().getModel("ui").setProperty("/isBusy",false)}})});
//# sourceMappingURL=Main.controller.js.map